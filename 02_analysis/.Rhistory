facet_grid(sim_type~mu)
fitness_df %>%
ggplot(aes(x = gen, y = mean_fitness, group = group=interaction(sim_type, seed), color = pop)) +
geom_line() +
facet_grid(sim_type~mu)
fitness_df %>%
ggplot(aes(x = gen, y = mean_fitness, group = group=interaction(sim_type, seed), color = pop)) +
geom_line() +
facet_grid(sim_type~mu)
fitness_df %>%
ggplot(aes(x = gen, y = mean_fitness, group = group=interaction(sim_type, seed), color = pop)) +
geom_line()
fitness_df %>%
ggplot(aes(x = gen, y = mean_fitness, group =interaction(sim_type, seed), color = pop)) +
geom_line() +
facet_grid(sim_type~mu)
fitness_df %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line() +
facet_grid(sim_type~mu)
fitness_df %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line() +
facet_grid(sim_type~mu)+
theme_classic()
fitness_df %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line() +
facet_grid(sim_type~mu)+
theme_minimal()
fitness_df %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line() +
facet_grid(sim_type~mu)+
theme_minimal()+
xlab("Generation")+
ylab("Mean fitness")
fitness_df %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line() +
facet_grid(sim_type~mu)+
theme_minimal()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palatte = "Set1")
fitness_df %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line() +
facet_grid(sim_type~mu)+
theme_minimal()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
fitness_df %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line() +
facet_grid(mu~sim_type)+
theme_minimal()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
fitness_df %>%
mutate(sim_type = gsub(".*_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line() +
facet_grid(mu~sim_type)+
theme_minimal()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
fitness_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line() +
facet_grid(mu~sim_type)+
theme_minimal()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
fitness_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line() +
facet_grid(mu~sim_type)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
ggsave("plots/fitness_plot.pdf", plot = fit_plot, device = "pdf")
fit_plot <- fitness_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line() +
facet_grid(mu~sim_type)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
ggsave("plots/fitness_plot.pdf", plot = fit_plot, device = "pdf")
ggsave("plots/fitness_plot.pdf", plot = fit_plot, device = "pdf", width = 7, height = 5)
fit_plot <- fitness_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line(size = 0.5) +
facet_grid(mu~sim_type)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
ggsave("plots/fitness_plot.pdf", plot = fit_plot, device = "pdf", width = 7, height = 5)
fit_plot <- fitness_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line(size = 0.1) +
facet_grid(mu~sim_type)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
ggsave("plots/fitness_plot.pdf", plot = fit_plot, device = "pdf", width = 7, height = 5)
fit_plot <- fitness_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop,seed), color = pop)) +
geom_line(size = 0.2) +
facet_grid(mu~sim_type)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
ggsave("plots/fitness_plot.pdf", plot = fit_plot, device = "pdf", width = 7, height = 5)
head(hap_df)
head(haplo_df)
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap")
interaction(pop, seed)
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = pop)) +
geom_line(size = 0.2) +
facet_grid(mu~sim_type)+
theme_bw()
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = pop)) +
geom_line(size = 0.2) +
facet_grid(mu~sim_type)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = pop)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = hap)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set2")
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set3")
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_viridis_d()
?scale_color_viridis_d
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_viridis_d(option = "magma")
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_viridis_d(option = "plasma")
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
scale_fill_gradient(low="blue", high="red")
colorRampPalette(c("black", "white"))
colorRampPalette(c("black", "white"))[8]
colorRampPalette(c("black", "white"))(8)
colorRampPalette(c("blue", "red"))(8)
haplo_palatte <- colorRampPalette(c("blue", "red"))(8)
haplo_palatte <- haplo_palatte[c(1,1,4,4,4,4,8,8)]
haplo_palatte
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_manual(values = haplo_palatte)
haplo_palatte <- haplo_palatte[c(1,2,4,4,4,4,8,7)]
haplo_palatte <- colorRampPalette(c("blue", "red"))(8)
haplo_palatte <- haplo_palatte[c(1,2,4,4,4,4,8,7)]
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_manual(values = haplo_palatte)
haplo_palatte <- colorRampPalette(c("blue", "red"))(8)
haplo_palatte <- haplo_palatte[c(1,3,4,4,4,4,8,6)]
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_manual(values = haplo_palatte)
haplo_palatte <- colorRampPalette(c("blue", "red"))(8)
haplo_palatte <- haplo_palatte[c(1,1,4,4,4,4,8,8)]
hap_plot <- haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_manual(values = haplo_palatte)
hap_plot
ggsave("plots/_haplo_plot.pdf", plot = fit_plot, device = "pdf", width = 7, height = 5)
ggsave("plots/haplo_plot.pdf", plot = fit_plot, device = "pdf", width = 7, height = 5)
ggsave("plots/haplo_plot.pdf", plot = hap_plot, device = "pdf", width = 7, height = 5)
# script for analysing the output of SLiM simulations
# 29-07-2021
library("tidyverse")
# read in simulation data -------------------------------------------------
haplo_files <- list.files("../01_simulations/output/haplotypes", full.names = TRUE)
fitness_files <- list.files("../01_simulations/output/fitness", full.names = TRUE)
# function for reading in a single simulation file
# and adding its meta data (from the file name) as columns
# handles haplotype ("hap") and fitness files separately
add_sim_info_as_columns <- function(x){
seed <- gsub(".*_", "", x) %>% gsub("[^0-9]*", "", .)
sim_type <- gsub(".*/", "", x) %>% gsub("_mu=.*", "", .)
mu <- gsub(".*_mu=", "", x) %>% gsub("_.*", "", .)
out_df <- read.table(x)
out_df <- data.frame(sim_type, seed, mu, out_df)
if (grepl("hap", x)){
names(out_df) <- c("sim_type", "seed", "mu", "gen", "pop", "hap_class", "haplotype", "frequency")
} else if (grepl("fitness", x)){
names(out_df) <- c("sim_type", "seed", "mu", "gen", "pop", "mean_fitness")
}
out_df
}
# read in haplotype frequencies
haplo_df <- lapply(haplo_files, add_sim_info_as_columns) %>%
bind_rows()
# read in fitness data
fitness_df <- lapply(fitness_files, add_sim_info_as_columns) %>%
bind_rows()
# plot simulation data ----------------------------------------------------
# plot of mean fitness vs generations
fit_plot <- fitness_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop, seed), color = pop)) +
geom_line(size = 0.2) +
facet_grid(mu~sim_type)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
ggsave("plots/fitness_plot.pdf", plot = fit_plot, device = "pdf", width = 7, height = 5)
# plot of haplotype freq vs generations
haplo_palatte <- colorRampPalette(c("blue", "red"))(8)
haplo_palatte <- haplo_palatte[c(1,1,4,4,4,4,8,8)]
hap_plot <- haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_manual(values = haplo_palatte)
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_manual(values = haplo_palatte)
colorRampPalette(c("blue", "red"))(8)
colorRampPalette(c("green", "red"))(8)
fitness_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop, seed), color = pop)) +
geom_line(size = 0.2) +
facet_grid(mu~sim_type)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
scale_color_brewer(palette = "Set1")
haplo_palatte <- haplo_palatte[c("#E41A1C","#E41A1C","#4DAF4A","#4DAF4A","purple","purple","#377EB8","#377EB8" )]
hap_plot <- haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_manual(values = haplo_palatte)
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_manual(values = haplo_palatte)
haplo_palatte <- c("#E41A1C","#E41A1C","#4DAF4A","#4DAF4A","purple","purple","#377EB8","#377EB8" )
haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_manual(values = haplo_palatte)
hap_plot <- haplo_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
filter(hap_class == "hap") %>%
filter(sim_type == "inversions") %>%
ggplot(aes(x = gen, y = frequency, group = interaction(pop, seed, haplotype), color = haplotype)) +
geom_line(size = 0.2) +
facet_grid(mu~pop)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_manual(values = haplo_palatte)
ggsave("plots/haplo_plot.pdf", plot = hap_plot, device = "pdf", width = 7, height = 5)
# script for analysing the output of SLiM simulations
# 29-07-2021
library("tidyverse")
# read in simulation data -------------------------------------------------
haplo_files <- list.files("../01_simulations/output/haplotypes", full.names = TRUE)
fitness_files <- list.files("../01_simulations/output/fitness", full.names = TRUE)
# function for reading in a single simulation file
# and adding its meta data (from the file name) as columns
# handles haplotype ("hap") and fitness files separately
add_sim_info_as_columns <- function(x){
seed <- gsub(".*_", "", x) %>% gsub("[^0-9]*", "", .)
sim_type <- gsub(".*/", "", x) %>% gsub("_mu=.*", "", .)
mu <- gsub(".*_mu=", "", x) %>% gsub("_.*", "", .)
out_df <- read.table(x)
out_df <- data.frame(sim_type, seed, mu, out_df)
if (grepl("hap", x)){
names(out_df) <- c("sim_type", "seed", "mu", "gen", "pop", "hap_class", "haplotype", "frequency")
} else if (grepl("fitness", x)){
names(out_df) <- c("sim_type", "seed", "mu", "gen", "pop", "mean_fitness")
}
out_df
}
# read in haplotype frequencies
haplo_df <- lapply(haplo_files, add_sim_info_as_columns) %>%
bind_rows()
# read in fitness data
fitness_df <- lapply(fitness_files, add_sim_info_as_columns) %>%
bind_rows()
head(fitness_df )
fitness_df %>%
mutate(sim_type = gsub("three_pop_", "", sim_type)) %>%
mutate(mu = paste0("mu=", mu)) %>%
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop, seed), color = pop)) +
geom_line(size = 0.2) +
facet_grid(mu~sim_type)+
theme_bw()+
xlab("Generation")+
ylab("Mean fitness")+
scale_color_brewer(palette = "Set1")
install.packages("inline")
