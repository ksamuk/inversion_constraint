ggplot(aes(x = gen, y = frequency, color = hap_class)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~m)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Migration Rate\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(pop == "pop1") %>%
ggplot(aes(x = gen, y = frequency, color = hap_class)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~m)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Migration Rate\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m = 0.01) %>%
filter(pop == "pop1") %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Migration Rate\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m = 0.01) %>%
filter(pop == "pop1") %>%
ggplot(aes(x = gen, y = frequency, color = hap_class)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Migration Rate\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m = 0.01) %>%
filter(pop == "pop1")
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01) %>%
filter(pop == "pop1") %>%
ggplot(aes(x = gen, y = frequency, color = hap_class)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Migration Rate\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Migration Rate\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.1) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Migration Rate\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Migration Rate\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.1) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Migration Rate\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Migration Rate = 0.01\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))+
title("Migration rate = 0.01")
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))+
plot_title("Migration rate = 0.01")
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
# script for analysing the output of SLiM simulations
# 29-07-2021 / altered on 18-11-2021
library("tidyverse")
library("gridExtra") # for plotting
# read in simulation data -------------------------------------------------
#setwd("/Users/Marius/Dropbox/My Mac (Mariusâ€™s MacBook Pro)/Desktop/Github/inversion_constraint")
setwd("..")
haplo_files.all <- list.files("01_simulations/data/slim_output/haplotypes", full.names = TRUE)
fitness_files.all <- list.files("01_simulations/data/slim_output/fitness", full.names = TRUE)
# check from how many simulations there are output files, and plot output for every individual simulation
seeds <-
haplo_files.all %>%
gsub(".*\\/[a-z.]*_", "", .) %>%
gsub("_haps.*", "", .) %>%
gsub(".*_", "", .)
info <-
haplo_files.all %>%
gsub(".*\\/[a-z.]*_", "", .) %>%
gsub("_.*", "", .)
#####################
# function for reading in a single simulation file
# and adding its meta data (from the file name) as columns
# handles haplotype ("hap") and fitness files separately
add_sim_info_as_columns <- function(x){
# seed
if(length(grep("haps",x))==1){
seed <- gsub("*_haps.txt", "", x) %>% gsub(".*_", "", .)}
if(length(grep("fitness",x))==1){
seed <- gsub("*_fitness.txt", "", x) %>% gsub(".*_", "", .)}
# simulation type (inversion present or absent?)
ifelse(length(grep(".inv=1_",x))==1,sim_type <- "inversion.present",sim_type <- "inversion.absent")
# mutation Rate
mu <- gsub(".*.mutR=", "", x) %>% gsub(".recR.*.", "", .)
# migration Rate
m <- gsub(".*_migR=", "", x) %>% gsub(".popS.*.", "", .)
# strength of selection
s <- gsub(".*selC=", "", x) %>% gsub(".inv=.*", "", .)
# inversion active
inv <- gsub(".*.inv=", "", x) %>% gsub("_.*", "", .)
out_df <- read.table(x)
out_df <- data.frame(sim_type, seed, m, s, mu, inv, out_df)
if (grepl("hap", x)){
names(out_df) <- c("sim_type", "seed", "m", "s", "mu", "inv", "gen", "pop", "hap_class", "haplotype", "frequency")
} else if (grepl("fitness", x)){
names(out_df) <- c("sim_type", "seed", "m", "s","mu", "inv", "gen", "pop", "mean_fitness", "optimal_adaptation")
}
out_df
}
# read in haplotype frequencies
haplo_df <- lapply(haplo_files.all, add_sim_info_as_columns) %>%
bind_rows()
# read in fitness data
fitness_df <- lapply(fitness_files.all, add_sim_info_as_columns) %>%
bind_rows()
fitness_df %>%
filter(s == 0.0025) %>%
mutate(mu = paste0("mu=", mu)) %>%
#ggplot(aes(x = gen, y = mean_fitness, color = pop)) + # "pop" is just set so all panels are in line
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop, seed), color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~m)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Migration Rate\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01, m==0) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
hap_plot <- haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01 | m==0) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01 | m==0) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m==0) %>%
ggplot(aes(x = gen, y = frequency, color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
hap_plot <- haplo_df %>%
filter(s == 0.0025) %>%
filter(m==0) %>%
ggplot(aes(x = gen, y = frequency, color = pop, group = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m==0) %>%
ggplot(aes(x = gen, y = frequency, color = pop, group = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m==0) %>%
ggplot(aes(x = gen, y = frequency, color = pop, group = interaction(pop, seed))) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m==0.1) %>%
ggplot(aes(x = gen, y = frequency, color = pop, group = interaction(pop, seed))) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.2) %>%
ggplot(aes(x = gen, y = frequency, color = pop, group = interaction(pop, seed))) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.1) %>%
ggplot(aes(x = gen, y = frequency, color = pop, group = interaction(pop, seed))) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
fitness_df %>%
filter(s == 0.0025) %>%
mutate(mu = paste0("mu=", mu)) %>%
#ggplot(aes(x = gen, y = mean_fitness, color = pop)) + # "pop" is just set so all panels are in line
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop, seed), color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~m)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Migration Rate\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01) %>%
ggplot(aes(x = gen, y = frequency, color = pop, group = interaction(pop, seed))) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.00) %>%
ggplot(aes(x = gen, y = frequency, color = pop, group = interaction(pop, seed))) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
filter(m == 0.01) %>%
ggplot(aes(x = gen, y = frequency, color = pop, group = interaction(pop, seed))) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
haplo_df %>%
filter(s == 0.0025) %>%
#filter(m == 0.01) %>%
filter(inv == 1) %>%
ggplot(aes(x = gen, y = frequency, color = pop, group = interaction(pop, seed))) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(m~hap_class)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Inversion Haplotype\n", breaks = NULL, labels = NULL))
fitness_df %>%
filter(s == 0.0025) %>%
mutate(mu = paste0("mu=", mu)) %>%
#ggplot(aes(x = gen, y = mean_fitness, color = pop)) + # "pop" is just set so all panels are in line
ggplot(aes(x = gen, y = mean_fitness, group = interaction(pop, seed), color = pop)) + # "pop" is just set so all panels are in line
geom_line(size = 0.3) +
#facet_grid(mu~sim_type) + # option 1
facet_grid(inv~m)+
theme_bw() +
ylim(0.88,1.22) +
xlab("Generation")+
ylab("Fitness")+
scale_color_brewer(palette = "Set1") +
scale_y_continuous(sec.axis = sec_axis(~ . , name = "Inversion Active?\n", breaks = NULL, labels = NULL)) +
scale_x_continuous(sec.axis = sec_axis(~ . , name = "Migration Rate\n", breaks = NULL, labels = NULL))
